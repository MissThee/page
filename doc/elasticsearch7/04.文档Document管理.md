## 文档Document相关操作
1. 创建文档
   + PUT http://localhost:9200/{Index}/{Type}/{_id} （Type：7和以上默认只能_doc；_id：是定义的本条数据的_id，不指定则自动分配）
   ```json
   {//请求体中这个对象即为添加的文档
       "id": 1,
       "title": "Vue简介",
       "content": "Vue 能够为复杂的单页应用提供驱动。"
   }
   ```
   添加完成后，可在图形化页面中“数据浏览”查看
2. 修改文档
   1. 覆盖式（不推荐）
      + 文档id一致时，覆盖相应的文档（引用Lucene实际操作为先删除后添加）
	  + POST http://localhost:9200/{Index}/{Type}/{_id}
	    ```json
        {
            "id": 1,
            "title": "Vue简介",
            "content": "Vue 能够为复杂的单页应用提供驱动。"
        }
		```
   2. 更新式
      + 仅更新指定的字段，其余不受影响
	  + POST http://localhost:9201/{Index}/{Type}/{_id}/_update
        ```json
        {
            "doc": {    //注意需加doc层
                "id": 2,
                "title": "天气预告3"
            }
        }
		```
3. 删除文档
   + DELETE http://localhost:9200/{Index}/{Type}/{_id} （Type：7和以上默认只能_doc；_id：是定义的本条数据的_id，不指定则自动分配）
4. 查询文档
   1. 通过_id查询
      + GET http://localhost:9200/{Index}/{Type}/{_id} （Type：7和以上默认只能_doc；_id：是定义的本条数据的_id，不指定则自动分配）
   2. 精确关键词查询，即所查询的字符串，必须与存储的数据分词结果中的一个完全匹配。（中文有bug即使使用了中文分词器，索查字段也确实与其中至少一个分词结果完全匹配，也无法查出，简单解决方法是用match查询方法替代）
      + POST http://localhost:9200/{Index}/{Type}/_search （Type：7和以上默认只能_doc；_id：是定义的本条数据的_id，不指定则自动分配）
        ```json
        {
            "query": {
                "term": {   //term关键词查询。（将查询的字段与存储的内容分词后匹配。standard分词方式中文只能分成单字）
                    "title": "社"
                }
            }
        }
        ```
   3. querystring查询
         + POST http://localhost:9200/{Index}/{Type}/_search （Type：7和以上默认只能_doc；_id：是定义的本条数据的_id，不指定则自动分配）
           ```json
           {
               "query": {
                   "query_string": {   //query_string查询。（先将输入的字段进行分词，再与存储的内容分词后适配。standard分词方式中文只能分成单字）
                       "default_field":"content",
                       "query": "社会"
                   }
               }
           }
           ```
5. 删除所有文档
   + POST /{Index}}/{Type}/_delete_by_query?conflicts=proceed
   ```
   {
       "query": {
           "match_all": {}
       }
   }
   ```
## 图形化查询文档
1. 基本查询中
   + 多条件是must之间是and，should之间是or

## 批量操作
### 批量查询 _mget
1. 批量查询数据
   + GET http://localhost:9201/{Index}/_mget Index为_all时查询所有索引下文档
     ```json
     {
         "docs" : [
             {
                 "_id" : "1"
             },
             {
                 "_id" : "2"
             }
         ]
     }
     ```
	 或  简写
	 ```json
	 {"ids": [1, 2]}
     ```
	 或  指定Type、指定要获取的字段
	 ```json
	 {
         "docs" : [
             {
				 "_type":"_doc",
                 "_id" : "1",
				 "_source": "title"
             },
             {
                 "_id" : "2",
				 "_source": ["content","title"]
             }
         ]
     }
	 ```
### 批量操作 _bulk
1. 请求体格式。（注意结尾行最后也要有换行符）
   ```
   {action:{metadata}}\n
   {request body}\n
   {action:{metadata}}\n
   {request body}\n
   ```
   | action | 功能 |
   | --- | --- |
   | create | 文档不存在时创建 |
   | index | 创建新文档或替换已有文档 |
   | update | 局部更新文档 |
   | delete | 删除一个文档，必须指定_id |
   例：注意此参数为application/json，但整体参数不符合json格式，不能任意换行，换行符为分隔数据的字符，最后一行结尾也需要换行
   + POST /{Index}/{Type}/_bulk
     ```json
     {"index": {"_index": "blog1","_type": "_doc"}}
     {"id": 7,"title": "bulk测试1","content": "能批量新增了！！"}
     {"index": {}}
     {"id": 8,"title": "bulk测试2","content": "批量再加一条数据"}
     {"create": {"_id": 9}}
     {"id": 9,"title": "bulk测试3","content": "这是旧值应该被改写"}
     {"update": {"_id": 9}}
     {"doc": {"content": "这是新值了！！"}}
     {"create": {"_id": 10}}
     {"id": 10,"title": "bulk测试4","content": "应该看不到这一条"}
     {"delete": {"_index": "blog1","_type": "_doc","_id": 10}}

     ```
     bulk操作数据量特别大时可能有性能问题，需要测试

## 版本控制
#### 旧版（es7以下）
1. 增加/查询文档时返回值中有`_version`字段，初始为1，且值为整数
2. 更新文档后，`_version`值会+1
3. 版本控制更新，url中加了?version=xxx参数，此xxx值需等于此文档现`_version`值，否侧报错
   + POST http://localhost:9201/{Index}/{Type}/{_id}?version=3
#### 新版（es7或更高），
1. 默认版本控制
   1. 增加/查询文档时返回值中有`_seq_no`（序号）,`_primary_term`（分片）字段，且值为整数
   2. 更新文档后，`_seq_no`会更新,`_primary_term`可能会更新
   3. 版本控制更新，url中加了?if_seq_no=xxx&if_primary_term=yyy参数，此xxx，yyy值需等于此文档现`_seq_no`,`_primary_term`值，否侧报错。
      + POST http://localhost:9201/{Index}/{Type}/{_id}?if_seq_no=10&if_primary_term=2
2. 使用`_version`版本控制（旧版也可用此方式）
   + 必需使用`version_external=external`自定义version，否则报错且提示用`_seq_no`,`_primary_term`
   + 使用`version_external=external`后，判断逻辑改变，请求中version值需大于文档现_version值，才能成功，否则报错。更新成功后，_version值会被设置为请求中version值
   + POST http://localhost:9201/{Index}/{Type}/{_id}?version=10&version_type=external
