(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e0318e6"],{"07e3":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"1bc3":function(e,t,n){var i=n("f772");e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(e,t,n){var i=n("f772"),o=n("e53d").document,r=i(o)&&i(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},"294c":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"2f21":function(e,t,n){"use strict";var i=n("79e5");e.exports=function(e,t){return!!e&&i((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"30ce":function(e,t,n){t=e.exports=n("24fb")(!0),t.push([e.i,".custom-tree-node[data-v-7eb2e45f]{flex:1;display:flex;align-items:center;justify-content:space-between;font-size:14px;padding-right:8px}.el-button--mini[data-v-7eb2e45f],.el-button--mini.is-round[data-v-7eb2e45f]{padding:3px}[data-v-7eb2e45f] .el-loading-spinner .circular{margin-top:11px;height:20px;width:20px;-webkit-animation:loading-rotate 2s linear infinite;animation:loading-rotate 2s linear infinite}.tool-bar-label[data-v-7eb2e45f]{font-weight:bolder;font-size:14px;color:#555}","",{version:3,sources:["P:/page/src/docviewer/views/content/md/src/docviewer/views/content/md/MarkdownDoc.vue"],names:[],mappings:"AA+XA,mCACA,MAAA,CACA,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,cAAA,CACA,iBACA,CAGA,6EACA,WACA,CAGA,gDACA,eAAA,CACA,WAAA,CACA,UAAA,CACA,mDAAA,CACA,2CACA,CAEA,iCACA,kBAAA,CACA,cAAA,CACA,UACA",file:"MarkdownDoc.vue?vue&type=style&index=0&id=7eb2e45f&scoped=true&lang=css&",sourcesContent:['<template>\n  <div style="margin:0 10%;">\n    <div v-show="isShowTree">\n      <div class="reduce-height-element">\n        <el-tag type="info" size="large" style="color:#555;font-weight: bolder">目录深度(0不限):\n          <el-input-number size="mini" :min="0" :max="99999" label="" v-model="treeDeep"></el-input-number>\n          <el-button type="primary" size="small" style="margin-left:10px" plain @click="initTreeData">加载列表</el-button>\n        </el-tag>\n        <div style="float: right">\n          <el-tag type="info" size="large" @click="isShowTree=true" style="color:#555;font-weight: bolder">根目录:</el-tag>\n          <el-tag type="info" size="large" @click="isShowTree=true" style="color:#555;font-weight: bolder">{{currentSettingValue.repository}}</el-tag>\n          <el-tag type="info" size="large" @click="isShowTree=true" style="color:#555;font-weight: bolder">{{currentSettingValue.docRoot}}</el-tag>\n        </div>\n        <el-input class="reduce-height-element" placeholder="输入关键字进行过滤" v-model="filterText"></el-input>\n      </div>\n      <div ref="treeArea" style="overflow: scroll" :style="{height: tableAutoHeight+\'px\'}">\n        <el-tree :default-expanded-keys="defaultExpandedKeys" :load="loadNode" lazy ref="fileTree" :filter-node-method="filterNode" :data="treeData" node-key="id" :props="defaultProps">\n        <span class="custom-tree-node" slot-scope="{ node, data }">\n          <span :style="{fontWeight:data.type===\'dir\'?\'bold\':\'\'}"><i :class="fileIcon(data.type,data.name)"></i>{{ node.label }}</span>\n          <span>\n            <span title="预览" style="width: 2em;display: inline-block">\n                <el-button\n                  v-if="showPreviewButton(data)"\n                  style="color:#67c23a;"\n                  plain\n                  size="mini"\n                  @click="() => {previewHandler(data);}">\n                <i class="el-icon-view"></i>\n                </el-button>\n            </span>\n            <span title="下载" style="width: 2em;display: inline-block">\n                <el-button\n                  v-loading="node.loading"\n                  v-if="data.download_url&&data.download_url.length>0"\n                  style="color:#e6a23c;"\n                  plain\n                  size="mini"\n                  @click="() => {downloadFileHandler(data.download_url,data.name,node);}">\n                  <i class="el-icon-download"></i>\n                </el-button>\n            </span>\n             <span title="原文件链接" style="width: 2em;display: inline-block">\n                <el-button\n                  style="color:#555555;"\n                  v-if="data.download_url&&data.download_url.length>0"\n                  plain\n                  size="mini">\n                  <a :href="data.download_url" target="_blank">\n                    <i class="el-icon-link"></i>\n                  </a>\n                </el-button>\n            </span>\n            <span title="前往github查看" style="width: 2em;display: inline-block">\n                <el-button\n                  style="color:#409eff;"\n                  plain\n                  size="mini">\n                   <a :href="data.html_url" target="_blank">\n                    <i class="el-icon-top-right"></i>\n                   </a>\n                </el-button>\n             </span>\n          </span>\n        </span>\n        </el-tree>\n      </div>\n      <div @click="scrollTreeToTop" v-if="isShowScrollTreeToTop" style="position: fixed;right: 2%;bottom: 160px;border: 1px solid #ccc;border-radius: 5px;text-align: center;vertical-align: middle;font-size: 10px;font-weight: bold;padding:8px;cursor: pointer;color:#666666"><i\n        class="el-icon-arrow-up"></i><br/>返<br/>回<br/>顶<br/>部\n      </div>\n      <el-dialog :close-on-click-modal="false" :visible.sync="isShowImagePreview" append-to-body title="图片预览">\n        <img width="100%" :src="currentImagePreviewFile.download_url" alt="图片预览">\n      </el-dialog>\n    </div>\n    <div v-if="!isShowTree" style="text-align: center">\n      <div class="reduce-height-element">\n        <div>\n          <el-button type="warning" size="mini" plain @click="backToTreeHandler" icon="el-icon-arrow-left">返回列表</el-button>\n          <el-button type="primary" size="mini" plain @click="switchEdit" icon="el-icon-edit">编辑/预览</el-button>\n        </div>\n        <div>\n          <el-tag type="info" size="mini" @click="isShowTree=true" style="color:#555;font-weight: bolder">当前文档：{{decodeURI(currentMdEditorFile.path)}}</el-tag>\n        </div>\n      </div>\n      <mark-down-area @save="preSaveMdFile" :height="tableAutoHeight" ref="md" :file-url="currentMdEditorFile.download_url"></mark-down-area>\n      <el-dialog style="text-align: center" :close-on-click-modal="false" :visible.sync="isShowPreSaveMdFileDialog" append-to-body title="提交">\n        <el-input placeholder="personal access token (保存在本地cookie)" v-model="token"></el-input>\n        <el-button :loading="currentMdEditorFileSaveButtonLoading" style="margin-top: 10px" type="primary" plain size="small" @click="sendSaveMdFile">确定</el-button>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n<script>\n  import MarkDownArea from \'src/docviewer/views/common/MarkDownArea\';\n  import MdApi from \'src/docviewer/api/md-api\';\n  import SimpleAutoHeightTable from \'src/docviewer/mixin/SimpleAutoHeightTable\';\n  import Cookie from \'src/docviewer/utils/cookies\';\n  import { mapGetters, mapActions } from \'vuex\';\n\n  export default {\n    name: \'MarkdownDoc\',\n    mixins: [SimpleAutoHeightTable],\n    components: {\n      MarkDownArea\n    },\n    data() {\n      return {\n        currentSettingValue: {\n          repository: \'\',\n          docRoot: \'\',\n        },\n        currentMdEditorFileValue: \'\',\n        isShowPreSaveMdFileDialog: false,\n        token: \'\',\n        isShowTree: true,\n        currentMdEditorFile: {},\n        currentMdEditorFileSaveButtonLoading: false,\n        currentImagePreviewFile: {},\n\n        filterText: \'\',\n        treeDeep: 1,\n        isShowScrollTreeToTop: false,\n        isShowImagePreview: false,\n        defaultExpandedKeys: [],\n        defaultProps: {\n          children: \'children\',\n          label: \'name\',\n          isLeaf: \'leaf\'\n        },\n        treeData: [],\n      };\n    },\n    created() {\n      this.$nextTick(() => {\n        this.$refs.treeArea.addEventListener(\'scroll\', this.treeAreaScrollHandler);\n      });\n    },\n    activated() {\n      if (!Cookie.token.getTokenValue()) {\n        this.$notify({\n          type: \'error\',\n          title: \'需要先设置授权信息\',\n          message: \'先到“设置”里登录，或设置token\'\n        });\n        this.$router.push(\'/setting\');\n        return;\n      }\n      if (this.currentSettingValue.repository !== Cookie.repository.getRepositoryValue() || this.currentSettingValue.docRoot !== Cookie.docRoot.getDocRootValue()) {\n        this.currentSettingValue.repository = Cookie.repository.getRepositoryValue();\n        this.currentSettingValue.docRoot = Cookie.docRoot.getDocRootValue();\n        this.initTreeData();\n      }\n    },\n    methods: {\n      initTreeData() {\n        this.treeData = [];\n        this.defaultExpandedKeys = [];\n        this.requestTreeData(\'https://api.github.com/repos/\' + this.getUser.login + \'/\' + Cookie.repository.getRepositoryValue() + \'/contents\' + Cookie.docRoot.getDocRootValue(), this.treeData, undefined, this.treeDeep);\n      },\n      requestTreeData(url, treeData, nodeDeep, limitDeep) {\n        nodeDeep = nodeDeep || 0;\n        nodeDeep++;\n        if (limitDeep !== 0 && limitDeep < nodeDeep) {\n          return;\n        }\n        MdApi.getFileFromGithub({ url: url === undefined ? \'\' : url })\n          .then(({ data }) => {\n            data = data.sort(this.sortMethod);\n            data.forEach((item) => {\n              let node = item;\n              node.deep = nodeDeep;//节点深度，树中由1开始\n              node.leaf = item.type === \'file\';\n              node.id = item.path;\n              if (item.type === \'dir\') {\n                if (limitDeep === 0 || nodeDeep < limitDeep) {\n                  this.defaultExpandedKeys.push(node.id);\n                }\n                node.children = [];\n                this.requestTreeData(item.url, node.children, nodeDeep, limitDeep);\n              }\n              treeData.push(node);\n            });\n          });\n      },\n      showPreviewButton(data) {\n        if (data.type === \'file\') {\n          if (data.name.lastIndexOf(\'.\') > 0) {\n            switch (data.name.substring(data.name.lastIndexOf(\'.\') + 1)\n              .toLowerCase()) {\n              case \'md\':\n              case \'jpg\':\n              case \'png\':\n              case \'jpeg\':\n              case \'bmp\':\n              case \'gif\':\n                return true;\n              default:\n                return false;\n            }\n          }\n        }\n      },\n      previewHandler(data) {\n        if (data.name.lastIndexOf(\'.\') > 0) {\n          switch (data.name.substring(data.name.lastIndexOf(\'.\') + 1)\n            .toLowerCase()) {\n            case \'md\':\n              this.isShowTree = false;\n              this.currentMdEditorFile = data;\n              this.initSize();\n              break;\n            case \'jpg\':\n            case \'png\':\n            case \'jpeg\':\n            case \'bmp\':\n            case \'gif\':\n              this.currentImagePreviewFile = data;\n              this.isShowImagePreview = true;\n              break;\n          }\n        }\n      },\n      switchEdit() {\n        this.$refs.md.switchEdit();\n      },\n      downloadFileHandler(url, fileName, node) {\n        node.loading = true;\n        const Http = new XMLHttpRequest();\n        Http.responseType = \'arraybuffer\';\n        Http.open(\'GET\', url);\n        Http.send();\n        Http.onreadystatechange = () => {\n          try {\n            if (Http.readyState === 4) {\n              if (Http.status === 200) {\n                const content = Http.response;\n                const blob = new Blob([content]);\n                if (\'download\' in document.createElement(\'a\')) { // （非IE下载）\n                  const elink = document.createElement(\'a\');\n                  elink.download = fileName;\n                  elink.style.display = \'none\';\n                  elink.href = URL.createObjectURL(blob);\n                  document.body.appendChild(elink);\n                  elink.click();\n                  URL.revokeObjectURL(elink.href); // （释放URL 对象）\n                  document.body.removeChild(elink);\n                } else { // （IE10+下载）\n                  navigator.msSaveBlob(blob, fileName);\n                }\n              } else {\n                console.log(\'下载出错\');\n              }\n            }\n          } catch (e) {\n            console.log(\'下载出错\', e);\n          } finally {\n            setTimeout(() => {\n              node.loading = false;\n            }, 1500);\n          }\n        };\n      },\n      fileIcon(type, name) {\n        if (type === \'dir\') {\n          return { \'el-icon-folder\': true };\n        } else {\n          return { \'\': true };\n        }\n      },\n      scrollTreeToTop() {\n        this.$refs.treeArea.scrollTop = 0;\n      },\n      filterNode(value, data) {\n        if (!value) return true;\n        return data.name.indexOf(value) !== -1;\n      },\n      treeAreaScrollHandler() {\n        this.isShowScrollTreeToTop = this.$refs.treeArea.scrollTop > this.tableAutoHeight;\n      },\n      loadNode(node, resolve) {\n        if (node.data.deep < this.treeDeep || this.treeDeep === 0) {\n          setTimeout(() => {\n            return resolve(node.data.children);\n          }, 500);\n        } else {\n          if (node.data.type === \'dir\') {\n            MdApi.getFileFromGithub({ url: node.data.url })\n              .then((result) => {\n                if (result && result.data && result.data instanceof Array) {\n                  let data = result.data.sort(this.sortMethod);\n                  let childrenTreeData = [];\n                  data.forEach((item) => {\n                    let node = item;\n                    node.leaf = item.type === \'file\';\n                    childrenTreeData.push(node);\n                  });\n                  setTimeout(() => {\n                    return resolve(childrenTreeData);\n                  }, 500);\n                }\n              });\n          } else {\n            return resolve([]);\n          }\n        }\n      },\n      sortMethod(a, b) {\n        let aValue = (a.type === \'dir\' ? \'1\' : \'0\') + a.name;\n        let bValue = (b.type === \'dir\' ? \'1\' : \'0\') + b.name;\n        for (let i = 0; i < aValue.length && i < bValue.length; i++) {\n          if (aValue.charAt(i) !== bValue.charAt(i)) {\n            return aValue.charAt(i) - bValue.charAt(i) > 0 ? -1 : 1;\n          }\n        }\n        return 0;\n      },\n      preSaveMdFile(value) {\n        let tokenInCookie = Cookie.token.getTokenValue();\n        if (tokenInCookie) {\n          this.token = tokenInCookie;\n        }\n        this.currentMdEditorFileValue = value;\n        this.isShowPreSaveMdFileDialog = true;\n\n      },\n      sendSaveMdFile() {\n        Cookie.token.setTokenValue(this.token);\n        this.isShowPreSaveMdFileDialog = false;\n        this.currentMdEditorFileSaveButtonLoading = true;\n        MdApi.saveMdFile({\n          token: this.token,\n          url: this.currentMdEditorFile.url,\n          sha: this.currentMdEditorFile.sha,\n          content: Base64.toBase64(this.currentMdEditorFileValue),\n        })\n          .then((result) => {\n            if (result.status === 200) {\n              this.$notify({\n                title: \'保存成功\',\n                type: \'success\'\n              });\n              //更新sha值\n              MdApi.getFileFromGithub({ url: result.data.content.url })\n                .then((result) => {\n                  this.currentMdEditorFile.sha = result.data.sha;\n                  setTimeout(() => {\n                    this.currentMdEditorFileSaveButtonLoading = false;\n                  }, 1000);\n                });\n            } else {\n              this.$notify({\n                title: \'保存失败\',\n                type: \'error\'\n              });\n            }\n          })\n          .finally(() => {\n            setTimeout(() => {\n              this.currentMdEditorFileSaveButtonLoading = false;\n            }, 1000);\n          });\n      },\n      backToTreeHandler() {\n        this.isShowTree = true;\n        this.initSize();\n      },\n\n    },\n    computed: {\n      ...mapGetters({\n        contentHeight: \'layout/getContentHeight\',\n        contentWidth: \'layout/getContentWidth\',\n        getUser: \'user/getUser\'\n      }),\n    },\n    watch: {\n      filterText(val) {\n        this.$refs.fileTree.filter(val);\n      }\n    },\n  };\n<\/script>\n\n<style scoped>\n  .custom-tree-node {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 14px;\n    padding-right: 8px;\n  }\n\n  /*缩小按钮*/\n  .el-button--mini, .el-button--mini.is-round {\n    padding: 3px;\n  }\n\n  /*缩小加载动画*/\n  /deep/ .el-loading-spinner .circular {\n    margin-top: 11px;\n    height: 20px;\n    width: 20px;\n    -webkit-animation: loading-rotate 2s linear infinite;\n    animation: loading-rotate 2s linear infinite;\n  }\n\n  .tool-bar-label {\n    font-weight: bolder;\n    font-size: 14px;\n    color: #555555;\n  }\n</style>\n']}])},"35e8":function(e,t,n){var i=n("d9f6"),o=n("aebd");e.exports=n("8e60")?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},"454f":function(e,t,n){n("46a7");var i=n("584a").Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},"456d":function(e,t,n){var i=n("4bf8"),o=n("0d58");n("5eda")("keys",(function(){return function(e){return o(i(e))}}))},"46a7":function(e,t,n){var i=n("63b6");i(i.S+i.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},"55dd":function(e,t,n){"use strict";var i=n("5ca1"),o=n("d8e8"),r=n("4bf8"),a=n("79e5"),l=[].sort,s=[1,2,3];i(i.P+i.F*(a((function(){s.sort(void 0)}))||!a((function(){s.sort(null)}))||!n("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(r(this)):l.call(r(this),o(e))}})},"55ef":function(e,t,n){var i=n("30ce");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("499e").default;o("35542f6c",i,!0,{sourceMap:!0,shadowMode:!1})},"584a":function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},"5dbc":function(e,t,n){var i=n("d3f4"),o=n("8b97").set;e.exports=function(e,t,n){var r,a=t.constructor;return a!==n&&"function"==typeof a&&(r=a.prototype)!==n.prototype&&i(r)&&o&&o(e,r),e}},"5eda":function(e,t,n){var i=n("5ca1"),o=n("8378"),r=n("79e5");e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*r((function(){n(1)})),"Object",a)}},"63b6":function(e,t,n){var i=n("e53d"),o=n("584a"),r=n("d864"),a=n("35e8"),l=n("07e3"),s="prototype",c=function(e,t,n){var d,u,f,p=e&c.F,h=e&c.G,g=e&c.S,m=e&c.P,b=e&c.B,y=e&c.W,v=h?o:o[t]||(o[t]={}),w=v[s],S=h?i:g?i[t]:(i[t]||{})[s];for(d in h&&(n=t),n)u=!p&&S&&void 0!==S[d],u&&l(v,d)||(f=u?S[d]:n[d],v[d]=h&&"function"!=typeof S[d]?n[d]:b&&u?r(f,i):y&&S[d]==f?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t[s]=e[s],t}(f):m&&"function"==typeof f?r(Function.call,f):f,m&&((v.virtual||(v.virtual={}))[d]=f,e&c.R&&w&&!w[d]&&a(w,d,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},"77bf":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("mavon-editor",{style:{height:0===e.height?"auto":e.height+"px"},attrs:{editable:e.editorOptions.editable,subfield:e.editorOptions.subfield,defaultOpen:e.editorOptions.defaultOpen,placeholder:e.editorOptions.placeholder,toolbarsFlag:e.editorOptions.toolbarsFlag,shortCut:e.editorOptions.shortCut,toolbars:e.toolbars},on:{save:e.save},model:{value:e.mdText,callback:function(t){e.mdText=t},expression:"mdText"}})],1)},o=[],r=(n("c5f6"),{name:"MarkDownArea",props:{mdText:{type:String,default:""},fileUrl:{type:String,default:""},height:{type:Number,default:0},editorOptions:{type:Object,default:function(){return{editable:!1,subfield:!1,defaultOpen:"preview",placeholder:"",toolbarsFlag:!1,shortCut:!0}}}},data:function(){return{toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0}}},created:function(){this.fileUrl&&""!==this.fileUrl&&(console.log("fileUrl",this.fileUrl),this.initMdByUrl())},methods:{initMdByUrl:function(){var e=this,t=new XMLHttpRequest;t.open("GET",this.fileUrl),t.send(),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&(e.mdText=t.responseText)}},switchEdit:function(){this.editorOptions.editable=!this.editorOptions.editable,this.editorOptions.toolbarsFlag=!this.editorOptions.toolbarsFlag,this.editorOptions.subfield=!this.editorOptions.subfield},save:function(e){this.$emit("save",e)},copyToClipboard:function(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="2em",t.style.height="2em",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{var n=document.execCommand("copy");this.$notify({title:n?"成功复制到剪贴板":"该浏览器不支持点击复制到剪贴板",type:n?"success":"warning",duration:2e3})}catch(i){this.$notify({title:"不支持点击复制到剪贴板",type:"warning",duration:2e3})}document.body.removeChild(t)}}}),a=r,l=n("2877"),s=Object(l["a"])(a,i,o,!1,null,"628b42a0",null);t["a"]=s.exports},"794b":function(e,t,n){e.exports=!n("8e60")&&!n("294c")((function(){return 7!=Object.defineProperty(n("1ec9")("div"),"a",{get:function(){return 7}}).a}))},"79aa":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},"7f7f":function(e,t,n){var i=n("86cc").f,o=Function.prototype,r=/^\s*function ([^ (]*)/,a="name";a in o||n("9e1e")&&i(o,a,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"85f2":function(e,t,n){e.exports=n("454f")},"8b97":function(e,t,n){var i=n("d3f4"),o=n("cb7c"),r=function(e,t){if(o(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(o){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},"8e60":function(e,t,n){e.exports=!n("294c")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"8e6e":function(e,t,n){var i=n("5ca1"),o=n("990b"),r=n("6821"),a=n("11e9"),l=n("f1ae");i(i.S,"Object",{getOwnPropertyDescriptors:function(e){var t,n,i=r(e),s=a.f,c=o(i),d={},u=0;while(c.length>u)n=s(i,t=c[u++]),void 0!==n&&l(d,t,n);return d}})},"990b":function(e,t,n){var i=n("9093"),o=n("2621"),r=n("cb7c"),a=n("7726").Reflect;e.exports=a&&a.ownKeys||function(e){var t=i.f(r(e)),n=o.f;return n?t.concat(n(e)):t}},"9b62":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{margin:"0 10%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTree,expression:"isShowTree"}]},[n("div",{staticClass:"reduce-height-element"},[n("el-tag",{staticStyle:{color:"#555","font-weight":"bolder"},attrs:{type:"info",size:"large"}},[e._v("目录深度(0不限):\n        "),n("el-input-number",{attrs:{size:"mini",min:0,max:99999,label:""},model:{value:e.treeDeep,callback:function(t){e.treeDeep=t},expression:"treeDeep"}}),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small",plain:""},on:{click:e.initTreeData}},[e._v("加载列表")])],1),n("div",{staticStyle:{float:"right"}},[n("el-tag",{staticStyle:{color:"#555","font-weight":"bolder"},attrs:{type:"info",size:"large"},on:{click:function(t){e.isShowTree=!0}}},[e._v("根目录:")]),n("el-tag",{staticStyle:{color:"#555","font-weight":"bolder"},attrs:{type:"info",size:"large"},on:{click:function(t){e.isShowTree=!0}}},[e._v(e._s(e.currentSettingValue.repository))]),n("el-tag",{staticStyle:{color:"#555","font-weight":"bolder"},attrs:{type:"info",size:"large"},on:{click:function(t){e.isShowTree=!0}}},[e._v(e._s(e.currentSettingValue.docRoot))])],1),n("el-input",{staticClass:"reduce-height-element",attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),n("div",{ref:"treeArea",staticStyle:{overflow:"scroll"},style:{height:e.tableAutoHeight+"px"}},[n("el-tree",{ref:"fileTree",attrs:{"default-expanded-keys":e.defaultExpandedKeys,load:e.loadNode,lazy:"","filter-node-method":e.filterNode,data:e.treeData,"node-key":"id",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,o=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",{style:{fontWeight:"dir"===o.type?"bold":""}},[n("i",{class:e.fileIcon(o.type,o.name)}),e._v(e._s(i.label))]),n("span",[n("span",{staticStyle:{width:"2em",display:"inline-block"},attrs:{title:"预览"}},[e.showPreviewButton(o)?n("el-button",{staticStyle:{color:"#67c23a"},attrs:{plain:"",size:"mini"},on:{click:function(){e.previewHandler(o)}}},[n("i",{staticClass:"el-icon-view"})]):e._e()],1),n("span",{staticStyle:{width:"2em",display:"inline-block"},attrs:{title:"下载"}},[o.download_url&&o.download_url.length>0?n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"node.loading"}],staticStyle:{color:"#e6a23c"},attrs:{plain:"",size:"mini"},on:{click:function(){e.downloadFileHandler(o.download_url,o.name,i)}}},[n("i",{staticClass:"el-icon-download"})]):e._e()],1),n("span",{staticStyle:{width:"2em",display:"inline-block"},attrs:{title:"原文件链接"}},[o.download_url&&o.download_url.length>0?n("el-button",{staticStyle:{color:"#555555"},attrs:{plain:"",size:"mini"}},[n("a",{attrs:{href:o.download_url,target:"_blank"}},[n("i",{staticClass:"el-icon-link"})])]):e._e()],1),n("span",{staticStyle:{width:"2em",display:"inline-block"},attrs:{title:"前往github查看"}},[n("el-button",{staticStyle:{color:"#409eff"},attrs:{plain:"",size:"mini"}},[n("a",{attrs:{href:o.html_url,target:"_blank"}},[n("i",{staticClass:"el-icon-top-right"})])])],1)])])}}])})],1),e.isShowScrollTreeToTop?n("div",{staticStyle:{position:"fixed",right:"2%",bottom:"160px",border:"1px solid #ccc","border-radius":"5px","text-align":"center","vertical-align":"middle","font-size":"10px","font-weight":"bold",padding:"8px",cursor:"pointer",color:"#666666"},on:{click:e.scrollTreeToTop}},[n("i",{staticClass:"el-icon-arrow-up"}),n("br"),e._v("返"),n("br"),e._v("回"),n("br"),e._v("顶"),n("br"),e._v("部\n    ")]):e._e(),n("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.isShowImagePreview,"append-to-body":"",title:"图片预览"},on:{"update:visible":function(t){e.isShowImagePreview=t}}},[n("img",{attrs:{width:"100%",src:e.currentImagePreviewFile.download_url,alt:"图片预览"}})])],1),e.isShowTree?e._e():n("div",{staticStyle:{"text-align":"center"}},[n("div",{staticClass:"reduce-height-element"},[n("div",[n("el-button",{attrs:{type:"warning",size:"mini",plain:"",icon:"el-icon-arrow-left"},on:{click:e.backToTreeHandler}},[e._v("返回列表")]),n("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-edit"},on:{click:e.switchEdit}},[e._v("编辑/预览")])],1),n("div",[n("el-tag",{staticStyle:{color:"#555","font-weight":"bolder"},attrs:{type:"info",size:"mini"},on:{click:function(t){e.isShowTree=!0}}},[e._v("当前文档："+e._s(decodeURI(e.currentMdEditorFile.path)))])],1)]),n("mark-down-area",{ref:"md",attrs:{height:e.tableAutoHeight,"file-url":e.currentMdEditorFile.download_url},on:{save:e.preSaveMdFile}}),n("el-dialog",{staticStyle:{"text-align":"center"},attrs:{"close-on-click-modal":!1,visible:e.isShowPreSaveMdFileDialog,"append-to-body":"",title:"提交"},on:{"update:visible":function(t){e.isShowPreSaveMdFileDialog=t}}},[n("el-input",{attrs:{placeholder:"personal access token (保存在本地cookie)"},model:{value:e.token,callback:function(t){e.token=t},expression:"token"}}),n("el-button",{staticStyle:{"margin-top":"10px"},attrs:{loading:e.currentMdEditorFileSaveButtonLoading,type:"primary",plain:"",size:"small"},on:{click:e.sendSaveMdFile}},[e._v("确定")])],1)],1)])},o=[],r=(n("8e6e"),n("456d"),n("bd86")),a=(n("7f7f"),n("ac6a"),n("55dd"),n("77bf")),l=n("dcdd"),s=(n("5fff"),{getFileFromGithub:function(e){return Object(l["a"])({method:"get",url:e.url})},saveMdFile:function(e){return Object(l["a"])({method:"put",headers:{Authorization:"token "+e.token},data:{message:"a new commit message from web",content:e.content,sha:e.sha},url:e.url})}}),c=n("5880");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={data:function(){return{tableAutoHeight:0}},created:function(){this.initSize()},watch:{contentHeight:function(e){this.setTableHeight(e)},contentWidth:function(){this.setTableHeight(this.contentHeight)}},methods:{initSize:function(){this.setTableHeight(this.contentHeight)},setTableHeight:function(e){var t=this;this.$nextTick((function(){for(var n=0,i=document.getElementsByClassName("reduce-height-element"),o=0;o<i.length;o++)n+=i[o].offsetHeight;t.tableAutoHeight=e-n}))}},computed:u({},Object(c["mapGetters"])({contentHeight:"getContentHeight",contentWidth:"getContentWidth"}))},p=f,h=n("b6df");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b={name:"MarkdownDoc",mixins:[p],components:{MarkDownArea:a["a"]},data:function(){return{currentSettingValue:{repository:"",docRoot:""},currentMdEditorFileValue:"",isShowPreSaveMdFileDialog:!1,token:"",isShowTree:!0,currentMdEditorFile:{},currentMdEditorFileSaveButtonLoading:!1,currentImagePreviewFile:{},filterText:"",treeDeep:1,isShowScrollTreeToTop:!1,isShowImagePreview:!1,defaultExpandedKeys:[],defaultProps:{children:"children",label:"name",isLeaf:"leaf"},treeData:[]}},created:function(){var e=this;this.$nextTick((function(){e.$refs.treeArea.addEventListener("scroll",e.treeAreaScrollHandler)}))},activated:function(){if(!h["a"].token.getTokenValue())return this.$notify({type:"error",title:"需要先设置授权信息",message:"先到“设置”里登录，或设置token"}),void this.$router.push("/setting");this.currentSettingValue.repository===h["a"].repository.getRepositoryValue()&&this.currentSettingValue.docRoot===h["a"].docRoot.getDocRootValue()||(this.currentSettingValue.repository=h["a"].repository.getRepositoryValue(),this.currentSettingValue.docRoot=h["a"].docRoot.getDocRootValue(),this.initTreeData())},methods:{initTreeData:function(){this.treeData=[],this.defaultExpandedKeys=[],this.requestTreeData("https://api.github.com/repos/"+this.getUser.login+"/"+h["a"].repository.getRepositoryValue()+"/contents"+h["a"].docRoot.getDocRootValue(),this.treeData,void 0,this.treeDeep)},requestTreeData:function(e,t,n,i){var o=this;n=n||0,n++,0!==i&&i<n||s.getFileFromGithub({url:void 0===e?"":e}).then((function(e){var r=e.data;r=r.sort(o.sortMethod),r.forEach((function(e){var r=e;r.deep=n,r.leaf="file"===e.type,r.id=e.path,"dir"===e.type&&((0===i||n<i)&&o.defaultExpandedKeys.push(r.id),r.children=[],o.requestTreeData(e.url,r.children,n,i)),t.push(r)}))}))},showPreviewButton:function(e){if("file"===e.type&&e.name.lastIndexOf(".")>0)switch(e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()){case"md":case"jpg":case"png":case"jpeg":case"bmp":case"gif":return!0;default:return!1}},previewHandler:function(e){if(e.name.lastIndexOf(".")>0)switch(e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()){case"md":this.isShowTree=!1,this.currentMdEditorFile=e,this.initSize();break;case"jpg":case"png":case"jpeg":case"bmp":case"gif":this.currentImagePreviewFile=e,this.isShowImagePreview=!0;break}},switchEdit:function(){this.$refs.md.switchEdit()},downloadFileHandler:function(e,t,n){n.loading=!0;var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e),i.send(),i.onreadystatechange=function(){try{if(4===i.readyState)if(200===i.status){var e=i.response,o=new Blob([e]);if("download"in document.createElement("a")){var r=document.createElement("a");r.download=t,r.style.display="none",r.href=URL.createObjectURL(o),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}else navigator.msSaveBlob(o,t)}else console.log("下载出错")}catch(a){console.log("下载出错",a)}finally{setTimeout((function(){n.loading=!1}),1500)}}},fileIcon:function(e,t){return"dir"===e?{"el-icon-folder":!0}:{"":!0}},scrollTreeToTop:function(){this.$refs.treeArea.scrollTop=0},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},treeAreaScrollHandler:function(){this.isShowScrollTreeToTop=this.$refs.treeArea.scrollTop>this.tableAutoHeight},loadNode:function(e,t){var n=this;if(e.data.deep<this.treeDeep||0===this.treeDeep)setTimeout((function(){return t(e.data.children)}),500);else{if("dir"!==e.data.type)return t([]);s.getFileFromGithub({url:e.data.url}).then((function(e){if(e&&e.data&&e.data instanceof Array){var i=e.data.sort(n.sortMethod),o=[];i.forEach((function(e){var t=e;t.leaf="file"===e.type,o.push(t)})),setTimeout((function(){return t(o)}),500)}}))}},sortMethod:function(e,t){for(var n=("dir"===e.type?"1":"0")+e.name,i=("dir"===t.type?"1":"0")+t.name,o=0;o<n.length&&o<i.length;o++)if(n.charAt(o)!==i.charAt(o))return n.charAt(o)-i.charAt(o)>0?-1:1;return 0},preSaveMdFile:function(e){var t=h["a"].token.getTokenValue();t&&(this.token=t),this.currentMdEditorFileValue=e,this.isShowPreSaveMdFileDialog=!0},sendSaveMdFile:function(){var e=this;h["a"].token.setTokenValue(this.token),this.isShowPreSaveMdFileDialog=!1,this.currentMdEditorFileSaveButtonLoading=!0,s.saveMdFile({token:this.token,url:this.currentMdEditorFile.url,sha:this.currentMdEditorFile.sha,content:Base64.toBase64(this.currentMdEditorFileValue)}).then((function(t){200===t.status?(e.$notify({title:"保存成功",type:"success"}),s.getFileFromGithub({url:t.data.content.url}).then((function(t){e.currentMdEditorFile.sha=t.data.sha,setTimeout((function(){e.currentMdEditorFileSaveButtonLoading=!1}),1e3)}))):e.$notify({title:"保存失败",type:"error"})})).finally((function(){setTimeout((function(){e.currentMdEditorFileSaveButtonLoading=!1}),1e3)}))},backToTreeHandler:function(){this.isShowTree=!0,this.initSize()}},computed:m({},Object(c["mapGetters"])({contentHeight:"layout/getContentHeight",contentWidth:"layout/getContentWidth",getUser:"user/getUser"})),watch:{filterText:function(e){this.$refs.fileTree.filter(e)}}},y=b,v=(n("ebe0"),n("2877")),w=Object(v["a"])(y,i,o,!1,null,"7eb2e45f",null);t["default"]=w.exports},aa77:function(e,t,n){var i=n("5ca1"),o=n("be13"),r=n("79e5"),a=n("fdef"),l="["+a+"]",s="​",c=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),u=function(e,t,n){var o={},l=r((function(){return!!a[e]()||s[e]()!=s})),c=o[e]=l?t(f):a[e];n&&(o[n]=c),i(i.P+i.F*l,"String",o)},f=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},ac6a:function(e,t,n){for(var i=n("cadf"),o=n("0d58"),r=n("2aba"),a=n("7726"),l=n("32e9"),s=n("84f2"),c=n("2b4c"),d=c("iterator"),u=c("toStringTag"),f=s.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(p),g=0;g<h.length;g++){var m,b=h[g],y=p[b],v=a[b],w=v&&v.prototype;if(w&&(w[d]||l(w,d,f),w[u]||l(w,u,b),s[b]=f,y))for(m in i)w[m]||r(w,m,i[m],!0)}},aebd:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},bd86:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("85f2"),o=n.n(i);function r(e,t,n){return t in e?o()(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},c5f6:function(e,t,n){"use strict";var i=n("7726"),o=n("69a8"),r=n("2d95"),a=n("5dbc"),l=n("6a99"),s=n("79e5"),c=n("9093").f,d=n("11e9").f,u=n("86cc").f,f=n("aa77").trim,p="Number",h=i[p],g=h,m=h.prototype,b=r(n("2aeb")(m))==p,y="trim"in String.prototype,v=function(e){var t=l(e,!1);if("string"==typeof t&&t.length>2){t=y?t.trim():f(t,3);var n,i,o,r=t.charCodeAt(0);if(43===r||45===r){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+t}for(var a,s=t.slice(2),c=0,d=s.length;c<d;c++)if(a=s.charCodeAt(c),a<48||a>o)return NaN;return parseInt(s,i)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(b?s((function(){m.valueOf.call(n)})):r(n)!=p)?a(new g(v(t)),n,h):v(t)};for(var w,S=n("9e1e")?c(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;S.length>k;k++)o(g,w=S[k])&&!o(h,w)&&u(h,w,d(g,w));h.prototype=m,m.constructor=h,n("2aba")(i,p,h)}},d864:function(e,t,n){var i=n("79aa");e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},d9f6:function(e,t,n){var i=n("e4ae"),o=n("794b"),r=n("1bc3"),a=Object.defineProperty;t.f=n("8e60")?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),o)try{return a(e,t,n)}catch(l){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},e4ae:function(e,t,n){var i=n("f772");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},e53d:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},ebe0:function(e,t,n){"use strict";var i=n("55ef"),o=n.n(i);o.a},f1ae:function(e,t,n){"use strict";var i=n("86cc"),o=n("4630");e.exports=function(e,t,n){t in e?i.f(e,t,o(0,n)):e[t]=n}},f772:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);